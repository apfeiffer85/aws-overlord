(ns aws-overlord.net-test
  (:require [clojure.test :refer :all]
            [aws-overlord.net :refer :all]))

(deftest test-split-cidr-one-bit
  (is (= (split-cidr "10.144.0.0/19", 1) ["10.144.0.0/20", "10.144.16.0/20"]))
  (is (= (split-cidr "10.144.0.0/20", 1) ["10.144.0.0/21", "10.144.8.0/21"])))

(deftest split-cidr-multiple-bits
  (is (= (split-cidr "10.144.0.0/21", 3) ["10.144.0.0/24",
                                          "10.144.1.0/24",
                                          "10.144.2.0/24",
                                          "10.144.3.0/24",
                                          "10.144.4.0/24",
                                          "10.144.5.0/24",
                                          "10.144.6.0/24",
                                          "10.144.7.0/24"]))
  (is (= (split-cidr "10.144.8.0/21", 3) ["10.144.8.0/24",
                                          "10.144.9.0/24",
                                          "10.144.10.0/24",
                                          "10.144.11.0/24",
                                          "10.144.12.0/24",
                                          "10.144.13.0/24",
                                          "10.144.14.0/24",
                                          "10.144.15.0/24"]))
  (is (= (split-cidr "10.144.16.0/20", 3) ["10.144.16.0/23",
                                           "10.144.18.0/23",
                                           "10.144.20.0/23",
                                           "10.144.22.0/23",
                                           "10.144.24.0/23",
                                           "10.144.26.0/23",
                                           "10.144.28.0/23",
                                           "10.144.30.0/23"])))