(ns aws-overlord.net-test
  (:require [clojure.test :refer :all]
            [aws-overlord.net :refer :all]))

(deftest test-split-cidr-one-bit
  (is (= (split-cidr "10.2.0.0/19", 1) ["10.2.0.0/20", "10.2.16.0/20"]))
  (is (= (split-cidr "10.2.0.0/20", 1) ["10.2.0.0/21", "10.2.8.0/21"])))

(deftest split-cidr-multiple-bits
  (is (= (split-cidr "10.2.0.0/21", 3) ["10.2.0.0/24",
                                        "10.2.1.0/24",
                                        "10.2.2.0/24",
                                        "10.2.3.0/24",
                                        "10.2.4.0/24",
                                        "10.2.5.0/24",
                                        "10.2.6.0/24",
                                        "10.2.7.0/24"]))
  (is (= (split-cidr "10.2.8.0/21", 3) ["10.2.8.0/24",
                                        "10.2.9.0/24",
                                        "10.2.10.0/24",
                                        "10.2.11.0/24",
                                        "10.2.12.0/24",
                                        "10.2.13.0/24",
                                        "10.2.14.0/24",
                                        "10.2.15.0/24"]))
  (is (= (split-cidr "10.2.16.0/20", 3) ["10.2.16.0/23",
                                         "10.2.18.0/23",
                                         "10.2.20.0/23",
                                         "10.2.22.0/23",
                                         "10.2.24.0/23",
                                         "10.2.26.0/23",
                                         "10.2.28.0/23",
                                         "10.2.30.0/23"])))